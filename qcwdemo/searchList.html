<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>搜索列表页</title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="author" content="yhq" />
    <link rel="stylesheet" type="text/css" href="js/css/search.css">
    <link rel="stylesheet" type="text/css" href="js/css/dropload.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <script type="text/javascript" src="js/jquery-3.0.0.min.js"></script>
    <!--<script data-main="js/js/main" src="js/js/require.min.js"></script> -->
    <script type="text/javascript">
        var docEl = document.documentElement,
            resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
            recalc = function() {
                docEl.style.fontSize = 10 * (docEl.clientWidth / 320) + 'px'; //设置根字体大小
            };
        window.addEventListener(resizeEvt, recalc, false);
        document.addEventListener('DOMContentLoaded', recalc, false);
</script>
</head>

<body>
<!-- 顶部头 -->
<header class="search_head">
        <div class="logo">
            <a><img src="js/images/lgin.png"></a>
        </div>
        <div class="search_serch">
                <span class="s1"></span>
                <input type="text" placeholder="寻找待售宝贝">
                <span class="s2"></span>
        </div>
</header>
<section>
<div class="com-title">
    <div class="order-by-way selected" ><span>上架时间</span></div>
    <div class="order-by-way"><span>价格</span></div>
    <a class="r">查看所有分类</a>
    <div class="clear"></div>
</div>

<!-- 搜索宠物犬 -->

   <div class="dpcplb_con">
               <div class="list2"><ul></ul></div>

    </div>
</section>
<!--<script>require(["app/searchList"])</script>
<script>

</script>-->
<script type="text/javascript" src="js/dropload.min.js"></script>
  <script type="text/javascript">
      $(function(){
                var counter = 0;
                // 每页展示4个
                var num = 4;
                var pageStart = 0,pageEnd = 0;

                // dropload
                $('.dpcplb_con').dropload({
                    scrollArea : window,
                    loadDownFn : function(me){
                        console.log("ajax开始");
                        $.ajax({
                            type: 'GET',
                            url: 'json/dpcplb.json',
                            dataType: 'json',
                            success: function(data){
                                var result = '';
                                counter++;
                                pageEnd = num * counter;
                                pageStart = pageEnd - num;
                                console.log("ajax请求成功");
                                for(var i = pageStart; i < pageEnd; i++){
                                    result +='<li>'+'<a href="'+data.lists[i].link+'">'
                                    +'<img src="'+data.lists[i].pic+'" alt=""/>'
                                    +'<p>'+data.lists[i].pcon1+'</p>'
                                    +'<span>'+data.lists[i].scon1+'</span>'+'<span class="dpjg">'+data.lists[i].scon2+'</span>'
                                    +'<p class="dpxy">'+data.lists[i].pcon2
                                    +'<img class="xinyu" src="'+data.lists[i].pic2+'" alt=""/>'
                                    +'<img class="xinyu" src="'+data.lists[i].pic2+'" alt=""/>'
                                    +'<img class="xinyu" src="'+data.lists[i].pic2+'" alt=""/>'
                                    +'<img class="xinyu" src="'+data.lists[i].pic2+'" alt=""/>'
                                    +'<img class="xinyu" src="'+data.lists[i].pic2+'" alt=""/>'
                                    +'</p>'
                                    +'<span>'+data.lists[i].scon3+'</span>'+'<span>'+data.lists[i].scon4+'</span>'
                                    +'</a>'+'</li>';
                                    if((i + 1) >= data.lists.length){
                                        // 锁定
                                        me.lock();
                                        // 无数据
                                        me.noData();
                                        break;
                                    }
                                }
                                // 为了测试，延迟1秒加载
                                setTimeout(function(){
                                    $('.list2 ul').append(result);
                                    // 每次数据加载完，必须重置
                                    me.resetload();
                                },1000);
                            },
                            error: function(xhr, type){
                                // alert('Ajax error!');
                                console.log("请求失败");
                                // 即使加载出错，也得重置
                                me.resetload();
                            }
                        });
                    }
                });
            // 第一块加载结束
            $(".order-by-way").on("click",function(){
                if($(this).hasClass("selected")){
                if($(this).hasClass("up")){
                    $(this).removeClass("up");
                }else{
                    $(this).addClass("up");
                }
                }else{
                $(".order-by-way").removeClass("selected");
                $(this).addClass("selected");
                }
            })
    });
  </script>
</body>
</html>