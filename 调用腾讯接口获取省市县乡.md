# 调用腾讯接口获取省市县乡

```

<!DOCTYPE html>
<html>
<head >
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <title>close-test</title>
    <style type="text/css">
    body {
        height:100%;
    }
    *{
        margin: 0px;
        padding: 0px;
    }
    .mask {
        position: fixed;
        top: 0px;
        left: 0px;
        right: 0px;
        bottom: 0px;
        z-index: 1111;
        background: rgba(0, 0, 0, 0.5);
    }
    .contain {
        width: 500px;
        height: 500px;
        margin: 0px auto;
        background: #e66e34;
    }
    p.capitalize{
     text-transform:capitalize 
    }
    </style>

</head>

<body>

<button>打开</button>
 
 
</style>
</head>
<body>
<p class="capitalize">test</p>


<select name="province" id="province">
    <option value="">省</option>
</select>
<select name="city" id="city">
    <option value="">市</option>
</select>
<select name="county" id="county">
    <option value="">县(区)</option>
</select>
<select name="area" id="area">
    <option value="">镇(乡)</option>
</select>


<script src="js/jquery-3.2.0.min.js"></script>
<script>
if($('#province').val() == '' || $('city').val() == ''){
    $('#city').val('');
    $('#county').val('');
    $('#area').val('');
}

$(function(){
    // debugger;/
    var param = {
        province: null, //传递参数省份id
        city: null, //传递参数市id
        county: null //传递参数县id
    }

    $.ajax({// 获取省直辖市列表
        method: 'get',
        url: 'https://apis.map.qq.com/ws/district/v1/list?output=jsonp&callback=func1&key=FINBZ-W2Z3P-OGCDR-VOZ7R-MWKFV-XXF7P',
        data:"{}",
        dataType: 'jsonp',
        processData: false,
        jsonpCallback: 'func1',
        success: function(res){
            // console.log(res.result);
            if (res.result != undefined) {
                res.result[0].forEach(function(el,index){
                    $('#province').append("<option value='"+el.id+"'>"+el.fullname+"</option>");
                })
            }
        },
        error: function(xhr,textcode){
            console.log(xhr,textcode);
        }
    })

    

    $('#province').on("change",function(province,city){// 获取城市列表
        var province = 'province';
        var city = 'city';
        getChild(province,city);
    })
    $('#city').on("change",function(city,county){// 获取县列表
        var county = 'county';
        var city = 'city';
        getChild(city,county);
    })
    $('#county').on("change",function(county,area){// 获取乡镇列表
        var county = 'county';
        var area = 'area';
        getChild(county,area);
    })

    function getChild(sel,nextsel){
        param[sel] = $('#'+sel).val();
        $('#'+nextsel).val('');//清空原数据
        $.ajax({
            method: 'get',
            url: 'https://apis.map.qq.com/ws/district/v1/getchildren?&id='+param[sel]+'&output=jsonp&callback=func1&key=FINBZ-W2Z3P-OGCDR-VOZ7R-MWKFV-XXF7P',
            data:"{}",
            dataType: 'jsonp',
            processData: false,
            jsonpCallback: 'func1',
            success: function(res){
                // console.log(res);
                if (res.result != undefined) {
                    
                    res.result[0].forEach(function(el,index){
                        $('#'+nextsel).append("<option value='"+el.id+"'>"+el.fullname+"</option>");
                    })
                }
                
            },
            error: function(xhr,textcode){
                console.log(xhr,textcode);
            }
        })

    }

})
</script>
</body>
</html>
```
